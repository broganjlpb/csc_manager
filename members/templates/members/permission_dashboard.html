{% extends "base.html" %}

{% block title %}Permission Dashboard{% endblock %}

{% block content %}

<h3 class="mb-4">Permission Sources</h3>

{% for entry in dashboard %}
<div class="card mb-3">
    <div class="card-body">

        <h5>{{ entry.user.get_short_name }}</h5>
        <p class="text-muted">{{ entry.user.email }}</p>

        <hr>

        <table class="table table-sm">
            <thead>
                <tr>
                    <th>Permission</th>
                    <th>Direct</th>
                    <th>Via Groups</th>
                </tr>
            </thead>
            <tbody>
                {% for item in entry.permissions %}
                <tr>
                    <td>
                        {{ item.perm.content_type.app_label }} |
                        {{ item.perm.name }}
                    </td>

                    <td>
                        {% if item.direct %}
                            ✅
                        {% endif %}
                    </td>

                    <td>
                        {% for g in item.groups %}
                            <span class="badge bg-secondary">
                                {{ g.name }}
                            </span>
                        {% empty %}
                            —
                        {% endfor %}
                    </td>

                </tr>
                {% empty %}
                <tr>
                    <td colspan="3" class="text-muted text-center">
                        No permissions
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

    </div>
</div>
{% endfor %}

{% endblock %}

