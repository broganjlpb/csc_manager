{% load race_extras %}
<table class="table table-sm table-bordered">
<thead>
<tr>
    <th>Pos</th>
    <th>Boat</th>
    <th>Helm</th>
    <th>Laps</th>
    <th>Elapsed</th>
    <th>Corrected</th>
</tr>
</thead>
<tbody>
{% for row in rs.entries.all|dictsort:"finish_position" %}
<tr>
    <td><strong>{{ row.finish_position }}</strong></td>
    <td>{{ row.race_entry.boat }}</td>
    <td>{{ row.race_entry.helm.username }}</td>
    <td>{{ row.laps }}</td>
    <td>{{ row.elapsed_seconds|format_time }}</td>
    <td>{{ row.corrected_seconds|format_time }}</td>
</tr>
{% endfor %}
</tbody>
</table>

<hr>
<h6>Race Progression</h6>

<div class="d-flex gap-2 mb-2">
    <button class="btn btn-sm btn-outline-primary toggle-mode"
            data-rs="{{ rs.id }}"
            data-mode="actual">
        Actual
    </button>

    <button class="btn btn-sm btn-primary toggle-mode"
            data-rs="{{ rs.id }}"
            data-mode="corrected">
        Corrected
    </button>
</div>

<div style="height:220px;">
    <canvas id="chart{{ rs.id }}"></canvas>
</div>


<button class="btn btn-sm btn-outline-secondary"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#laps{{ rs.id }}">
    Show Lap Details
</button>

<div id="laps{{ rs.id }}" class="collapse mt-2">
    <small class="text-muted">
        (Full lap-by-lap view can be added here later)
    </small>
</div>
