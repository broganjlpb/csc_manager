{% extends "base.html" %}
{% block content %}

<h3>Manual Timed Results â€“ {{ race }}</h3>

<form method="post">
{% csrf_token %}

<table class="table table-sm align-middle">
<thead>
<tr>
    <th>Boat</th>
    <th>Helm</th>
    <th>Laps</th>
    <th>Time (hh:mm:ss)</th>
</tr>
</thead>

<tbody>
{% for row in entries %}
<tr>
    <td>{{ row.boat }}</td>
    <td>{{ row.helm.username }}</td>

    <td>
        <input type="number"
               name="laps_{{ row.id }}"
               value="{{ row.laps|default_if_none:'' }}"
               class="form-control form-control-sm">
    </td>

    <td>
        <div class="d-flex gap-1">
            <input type="number" min="0"
                   name="h_{{ row.id }}"
                   value="{{ row.h }}"
                   class="form-control form-control-sm"
                   placeholder="hh">

            <input type="number" min="0" max="59"
                   name="m_{{ row.id }}"
                   value="{{ row.m }}"
                   class="form-control form-control-sm"
                   placeholder="mm">

            <input type="number" min="0" max="59"
                   name="s_{{ row.id }}"
                   value="{{ row.s }}"
                   class="form-control form-control-sm"
                   placeholder="ss">
        </div>
    </td>
</tr>
{% endfor %}
</tbody>
</table>

<button name="action" value="save" class="btn btn-secondary">
    Save
</button>

<button name="action" value="preview" class="btn btn-primary">
    Preview
</button>

</form>

{% if preview %}
<hr>

<h4>Preview</h4>

<table class="table table-striped table-sm">
<thead>
<tr>
    <th>Pos</th>
    <th>Boat</th>
    <th>Helm</th>
    <th>Corrected</th>
    <th>Points</th>
</tr>
</thead>
<tbody>

{% for p in preview %}
<tr>
    <td><strong>{{ p.position }}</strong></td>
    <td>{{ p.entry.boat }}</td>
    <td>{{ p.entry.helm.username }}</td>
    <td>{{ p.corrected }}</td>
    <td>{{ p.points }}</td>
</tr>
{% endfor %}
</tbody>
</table>

{% endif %}

{% endblock %}
